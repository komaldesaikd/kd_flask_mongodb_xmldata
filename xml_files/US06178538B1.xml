<?xml version="1.0" encoding="UTF-8"?>
<questel-patent-document lang="en" date-produced="20180805" produced-by="Questel" schema-version="3.23" file="US06178538B1.xml">
  <bibliographic-data lang="en">
    <publication-reference publ-desc="Granted patent as first publication">
      <document-id>
        <country>US</country>
        <doc-number>06178538</doc-number>
        <kind>B1</kind>
        <date>20010123</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>US6178538</doc-number>
      </document-id>
    </publication-reference>
    <original-publication-kind>B1</original-publication-kind>
    <application-reference is-representative="YES" family-id="21806038" extended-family-id="42111540">
      <document-id>
        <country>US</country>
        <doc-number>09021766</doc-number>
        <kind>A</kind>
        <date>19980211</date>
      </document-id>
      <document-id data-format="questel">
        <doc-number>1998US-09021766</doc-number>
      </document-id>
      <document-id data-format="questel_Uid">
        <doc-number>43169040</doc-number>
      </document-id>
    </application-reference>
    <language-of-filing>en</language-of-filing>
    <language-of-publication>en</language-of-publication>
    <priority-claims>
      <priority-claim kind="national" sequence="1">
        <country>US</country>
        <doc-number>2176698</doc-number>
        <kind>A</kind>
        <date>19980211</date>
        <priority-active-indicator>Y</priority-active-indicator>
      </priority-claim>
      <priority-claim data-format="questel" sequence="1">
        <doc-number>1998US-09021766</doc-number>
      </priority-claim>
    </priority-claims>
    <dates-of-public-availability>
      <publication-of-grant-date>
        <date>20010123</date>
      </publication-of-grant-date>
    </dates-of-public-availability>
    <classifications-ipcr>
      <classification-ipcr sequence="1">
        <text>H03M  13/41        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>03</class>
        <subclass>M</subclass>
        <main-group>13</main-group>
        <subgroup>41</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
      <classification-ipcr sequence="2">
        <text>H03M  13/27        20060101A I20051008RMEP</text>
        <ipc-version-indicator>
          <date>20060101</date>
        </ipc-version-indicator>
        <classification-level>A</classification-level>
        <section>H</section>
        <class>03</class>
        <subclass>M</subclass>
        <main-group>13</main-group>
        <subgroup>27</subgroup>
        <classification-value>I</classification-value>
        <generating-office>
          <country>EP</country>
        </generating-office>
        <classification-status>R</classification-status>
        <classification-data-source>M</classification-data-source>
        <action-date>
          <date>20051008</date>
        </action-date>
      </classification-ipcr>
    </classifications-ipcr>
    <classification-national>
      <country>US</country>
      <main-classification>
        <text>714795000</text>
        <class>714</class>
        <subclass>795000</subclass>
      </main-classification>
      <further-classification sequence="1">
        <text>714796000</text>
        <class>714</class>
        <subclass>796000</subclass>
      </further-classification>
    </classification-national>
    <classifications-ecla>
      <classification-ecla sequence="1">
        <text>H03M-013/63P</text>
        <section>H</section>
        <class>03</class>
        <subclass>M</subclass>
        <main-group>013</main-group>
        <subgroup>63P</subgroup>
      </classification-ecla>
      <classification-ecla sequence="2">
        <text>H03M-013/27</text>
        <section>H</section>
        <class>03</class>
        <subclass>M</subclass>
        <main-group>13</main-group>
        <subgroup>27</subgroup>
      </classification-ecla>
      <classification-ecla sequence="3">
        <text>H03M-013/41A</text>
        <section>H</section>
        <class>03</class>
        <subclass>M</subclass>
        <main-group>013</main-group>
        <subgroup>41A</subgroup>
      </classification-ecla>
      <classification-ecla sequence="4">
        <text>H03M-013/65D</text>
        <section>H</section>
        <class>03</class>
        <subclass>M</subclass>
        <main-group>013</main-group>
        <subgroup>65D</subgroup>
      </classification-ecla>
    </classifications-ecla>
    <patent-classifications>
      <patent-classification sequence="1">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H03M-013/6343</classification-symbol>
        <section>H</section>
        <class>03</class>
        <subclass>M</subclass>
        <main-group>13</main-group>
        <subgroup>6343</subgroup>
        <symbol-position>F</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="2">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H03M-013/27</classification-symbol>
        <section>H</section>
        <class>03</class>
        <subclass>M</subclass>
        <main-group>13</main-group>
        <subgroup>27</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="3">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H03M-013/4107</classification-symbol>
        <section>H</section>
        <class>03</class>
        <subclass>M</subclass>
        <main-group>13</main-group>
        <subgroup>4107</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
      <patent-classification sequence="4">
        <classification-scheme office="EP" scheme="CPC">
          <date>20130101</date>
        </classification-scheme>
        <classification-symbol>H03M-013/6502</classification-symbol>
        <section>H</section>
        <class>03</class>
        <subclass>M</subclass>
        <main-group>13</main-group>
        <subgroup>6502</subgroup>
        <symbol-position>L</symbol-position>
        <classification-value>I</classification-value>
        <classification-status>B</classification-status>
        <classification-data-source>H</classification-data-source>
        <action-date>
          <date>20130101</date>
        </action-date>
      </patent-classification>
    </patent-classifications>
    <number-of-claims>17</number-of-claims>
    <exemplary-claim>15</exemplary-claim>
    <figures>
      <number-of-drawing-sheets>7</number-of-drawing-sheets>
      <number-of-figures>9</number-of-figures>
      <image-key data-format="questel">US6178538</image-key>
    </figures>
    <invention-title format="original" lang="en" id="title_en">Interleaved analog metric calculator</invention-title>
    <references-cited>
      <citation srep-phase="examiner">
        <patcit num="1">
          <text>ACAMPORA ANTHONY</text>
          <document-id>
            <country>US</country>
            <doc-number>4087787</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US4087787</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="2">
          <text>YAMASAKI RICHARD G</text>
          <document-id>
            <country>US</country>
            <doc-number>5384560</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5384560</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="3">
          <text>MINUHIN VADIM B, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5430768</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5430768</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="4">
          <text>MIYAMOTO BUN-ICHI, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5448583</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5448583</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="5">
          <text>STAFFORD KENNETH R, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5734680</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5734680</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="6">
          <text>KOVACS JANOS, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5768320</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5768320</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="7">
          <text>YAMAKAWA HIDEYUKI, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5844741</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5844741</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="8">
          <text>YAMASAKI RICHARD G, et al</text>
          <document-id>
            <country>US</country>
            <doc-number>5917859</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5917859</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <patcit num="9">
          <text>CHOI DAVY H</text>
          <document-id>
            <country>US</country>
            <doc-number>5933463</doc-number>
            <kind>A</kind>
          </document-id>
          <document-id data-format="questel">
            <doc-number>US5933463</doc-number>
          </document-id>
        </patcit>
      </citation>
      <citation srep-phase="examiner">
        <nplcit num="1">
          <text>Fukahori et al., "An Analog EPR4 Viterbi Detector in Read Channel IC for Magnetic Hard Disks", ISSCC98 Digest of Technical Papaers, pp. 380-381, Dec. 1998.</text>
        </nplcit>
      </citation>
    </references-cited>
    <parties>
      <applicants>
        <applicant data-format="original" app-type="applicant" sequence="1">
          <addressbook lang="en">
            <orgname>Texas Instruments, Incoporated</orgname>
            <address>
              <address-1>Dalllas, TX, US</address-1>
              <city>Dalllas</city>
              <state>TX</state>
              <country>US</country>
            </address>
          </addressbook>
          <nationality>
            <country>US</country>
          </nationality>
        </applicant>
        <applicant data-format="questel" app-type="applicant" sequence="2">
          <addressbook lang="en">
            <orgname>TEXAS INSTRUMENTS</orgname>
          </addressbook>
          <nationality>
            <country>US</country>
          </nationality>
        </applicant>
      </applicants>
      <inventors>
        <inventor data-format="original" sequence="1">
          <addressbook lang="en">
            <name>Fukahori, Kiyoshi</name>
            <address>
              <address-1>Tokyo, JP</address-1>
              <city>Tokyo</city>
              <country>JP</country>
            </address>
          </addressbook>
          <nationality>
            <country>JP</country>
          </nationality>
        </inventor>
      </inventors>
      <agents>
        <agent sequence="1" rep-type="agent">
          <addressbook lang="en">
            <name>Swayze, Jr., W. Daniels</name>
          </addressbook>
        </agent>
        <agent sequence="2" rep-type="agent">
          <addressbook lang="en">
            <name>Brady, III, W. James</name>
          </addressbook>
        </agent>
        <agent sequence="3" rep-type="agent">
          <addressbook lang="en">
            <name>Telecky, Jr., Frederick J.</name>
          </addressbook>
        </agent>
      </agents>
    </parties>
    <examiners>
      <primary-examiner>
        <name>Baker, Stephen</name>
      </primary-examiner>
    </examiners>
    <lgst-data>
      <lgst-status>EXPIRED</lgst-status>
    </lgst-data>
  </bibliographic-data>
  <abstract format="original" lang="en" id="abstr_en">
    <p id="P-EN-00001" num="00001">
      <br/>
      A metric calculator is disclosed having an interleaved structure for increasing the time during which metrics can be calculated by circuit components.
      <br/>
      A first interleave samples voltage of the received signal during a first phase and a second interleave samples voltage of the received signal during an opposite phase.
      <br/>
      The interleaved architecture calculates and updates metrics and decisions based on these metrics at code rate, without requiring completion of all ACS computations in one code period.
    </p>
  </abstract>
  <description format="original" lang="en" id="desc_en">
    <heading>BACKGROUND OF THE PRESENT INVENTION</heading>
    <p num="1">
      1.
      <br/>
      Field of the Invention
    </p>
    <p num="2">The present invention relates to the field of digital transmission through analog channels and, more particularly, to a method and apparatus for calculating metrics in a maximum likelihood detector for decoding a sequence of signals received through analog channels.</p>
    <p num="3">2. Background Art</p>
    <p num="4">
      Communication of voice and data signals is often accomplished by converting analog signals to digital signals.
      <br/>
      These digital signals are then transmitted from a transmitting device to a receiving device, converted back to analog signals, if necessary, and subsequently communicated to a user.
      <br/>
      This type of digital transmission is often performed through analog transmission channels.
      <br/>
      Digital information through this analog channel is transmitted in the form of "symbols" representing digital values.
      <br/>
      In some cases, adjacent symbols can overlap, resulting in a phenomenon known as intersymbol interference.
      <br/>
      This interference may corrupt a digital transmission, leading to errors in the receipt of the digital information.
    </p>
    <p num="5">
      These types of errors in transmission of digital information occur in many instances, including in magnetic recording channels.
      <br/>
      Such channels may suffer from intersymbol interference as well as noise present during transmission, and therefore require a method for decoding the binary symbol sequences that they output in a possibly corrupted form.
      <br/>
      Those skilled in the art are familiar with a decoding technique called maximum likelihood sequence estimation (MLSE), which is an effective tool used in conjunction with pulse detectors for receiving and decoding digital transmissions that suffer from intersymbol interference and noise.
      <br/>
      Maximum likelihood detection is especially useful with partial response signaling, for example class IV partial response signaling, in which the ideal response of a magnetic recording channel is modeled.
      <br/>
      Using the idealized response, and accounting for the effects of noise, maximum likelihood detection retrospectively analyzes received signals and determines the most likely sequence of data transmitted through the magnetic recording channel.
    </p>
    <p num="6">
      Class IV partial response signaling is only one type of partial response signaling currently used.
      <br/>
      In a class IV partial response, or PR4 system, when a pulse indicating a single magnetization transition occurs, it will ideally result in an impulse equal to "1" at the transition location and another impulse at the next sample period.
      <br/>
      The second impulse is equivalent to a response given by the operator (1+D).
      <br/>
      PR4 is a particular case of a more general family of PR polynomials, given by the general equation: (1-D)(1+D)n. PR4 corresponds to n=1.
      <br/>
      Another system, called EPR4, or "Enhanced Partial Response 4," is provided by setting n=2.
      <br/>
      In the EPR4 system, the impulse response caused by an isolated transition in a magnetic recording channel may be approximated by the term (1+D)2 =1+2D+D2.
      <br/>
      When n=3, the impulse response is given by the polynomial (1+D)3 =1+3D+3D2 +D3.
      <br/>
      This type of partial response is called E2 PR4.
      <br/>
      Because E2 PR4 is a higher order polynomial, it provides the closest fit to the magnetic channel frequency response, and is therefore a better predictor of the actual response of the magnetic channel.
      <br/>
      An embodiment of a metric calculator according to the present invention is disclosed with respect to the EPR4 system.
      <br/>
      However, it will be understood by those skilled in the art that the invention can also be applied to other systems, including PR4 and E2 PR4 systems.
    </p>
    <p num="7">
      Various implementations of maximum likelihood sequence estimation, in particular, the Viterbi algorithm, are well known in the art.
      <br/>
      Several of these implementations are discussed in U.S. Pat. No. 5,384,560, assigned to the assignee of the present application.
      <br/>
      A brief explanation of the EPR4 Viterbi detector is given here to facilitate the explanation of the present invention.
      <br/>
      A more complete explanation of the EPR4 Viterbi detector is provided in G. David Forney, Jr., "Maximum-Likelihood Sequence Estimation of Digital Sequences in the Presence of Intersymbol Interferences," IT-18 IEEE Transactions on Information Theory, 363 (May 1972), incorporated herein by reference.
    </p>
    <p num="8">
      The EPR4 Viterbi detector is a sequence detector for a signal channel whose response is characterized by the following EPR4 equation:
      <br/>
      (1-D)(1+D)2 =(1-D)(1+2D+D2),
    </p>
    <p num="9">
      where D is a delay operator representing one unit of delay or code period Tc.
      <br/>
      Using this equation, the Viterbi detector attempts to derive data that it computes to be most likely from a sequence of received signals.
    </p>
    <p num="10">
      The EPR4 channel is completely characterized by transitions associated with three binary bits: the current data bit (Ik), one bit just prior to it Ik-1, and another bit that is two code periods (2Tc) earlier Ik-2.
      <br/>
      It will be apparent to these skilled in the art that these three binary bits (Ik, Ik-1, Ik-2) fully describe one of the eight states in which the channel can be at time k. The EPR4 Viterbi detector assigns a measure of likelihood to all eight states at every code period, and derives data from the state that is determined to be most likely.
      <br/>
      As is known in the art, the value that is computed as a measure of likelihood is called a metric.
    </p>
    <p num="11">
      FIGS. 1(a)-1(d) are timelines illustrating a simple example of an EPR4 channel response.
      <br/>
      In the timeline shown in FIG. 1(a), the signal Iw represents a sequence of binary data input to the EPR4 channel.
      <br/>
      This signal can represent an input sequence 0011000, for example, after the data is processed in a read channel circuit and output as the current of a write flip flop circuit.
      <br/>
      At time k, the write current transitions from one to zero, or from high to low.
      <br/>
      In the ideal case where there is no noise, this transition generates an overall EPR4 response of Xk =0, shown at time=k in FIG. 1(d).
    </p>
    <p num="12">The timeline in FIG. 1(b) illustrates the (1-D) response to signal Iw, representing the differentiation process associated with the magnetic transition caused by the write current Iw onto the media.</p>
    <p num="13">
      The timeline in FIG. 1(c) is the PR4 response of the channel characterized by the multiplication of an additional (1+D) operator to the (1-D) differentiation signal.
      <br/>
      As can be seen from the figure, this is equivalent to time-shifting the (1-D) response by a unit delay, and adding the result to the (1-D) response.
      <br/>
      This function approximates the "spreading" of the magnetic transition of the FIG. 1(a) timeline over neighboring bit periods in a PR4 system.
    </p>
    <p num="14">
      Finally, the timeline in FIG. 1(d) shows the EPR4 response, which is obtained by further multiplying the PR4 response with yet another (1+D) operator.
      <br/>
      This response characterizes the response of the EPR4 channel for the signal shown in the FIG. 1(a) timeline.
      <br/>
      As can be seen from FIGS. 1(a) and 1(d), the ideal overall EPR4 response of Xk, in the absence of noise, for a transition from state "3" (011) to state "6" (011), at time k, is equal to zero.
    </p>
    <p num="15">
      FIGS. 2(a)-2(d) are timelines illustrating another simple example of an EPR4 channel response.
      <br/>
      In the timeline shown in FIG. 2(a), the signal Iw represents binary data input sequence of 0111000, outputted as current by the output of a flip flop in a read channel.
      <br/>
      As in FIG. 1(b), the timeline in FIG. 2(b) illustrates the (1-D) differentiation response to signal Iw.
      <br/>
      The timeline in FIG. 2(c) illustrates the PR4 response of the channel characterized by the multiplication of an additional (1+D) operator to the (1-D) differentiation signal.
      <br/>
      Finally, the timeline in FIG. 2(d) shows the EPR4 response for 0111000, obtained by further multiplying the PR4 response with another (1+D) operator.
    </p>
    <p num="16">
      As in FIG. 1(a), the timeline in FIG. 2(a) shows the write current transitioning from one to zero at time=k.
      <br/>
      However, the transition of the signal from state "7" or 111, to state "3" or 110, generates an ideal overall EPR4 response of xk =-1, shown at time=k in FIG. 2(d).
    </p>
    <p num="17">
      The ideal characteristic responses of the EPR4 channel in these examples can be used to derive metric equations for the different states of the channel.
      <br/>
      With reference to FIGS. 1(a) and 1(d), for example, at time=k, with no noise present, the ideal response of the channel is xk =0 and the channel is in state "6" or 110 in binary (with Ik-2, Ik-1 Ik=1,1,0).
      <br/>
      In the presence of noise, the response changes from xk to the actual response, yk.
      <br/>
      We can determine the likelihood of the channel being in the state "6" at time (t)=k as follows.
      <br/>
      To come to the state "6 "=110, the previous channel state (Ik-3, Ik-2, Ik-1) had to be either 011="3" or 111="7." Thus the metric calculator will limit itself to these two possibilities of what the previous channel could have been.
      <br/>
      This two-way decision approach is often called the "Radix 2" approach.
    </p>
    <p num="18">
      For the possibility that the previous channel state was "3," as shown in FIG. 1(a), the actual response is yk =xk +nk, where nk represents noise present in the actual response yk sample.
      <br/>
      As discussed above and shown in FIG. 1(d), the ideal response xk is equal to zero for the transition from "3" to "6." Therefore, if the previous channel state was "3," the actual response yk =0+nk =nk.
      <br/>
      However, if the previous channel state was "7," the response would be yk =-1+nk.
      <br/>
      This is shown in FIG. 2(d), where the ideal response, xk, for the transition from previous state "7" to current state "6" is equal to -1.
    </p>
    <p num="19">
      To determine which of the two previous states, "3" or "7," is most likely the correct state, we determine which transition to "6" results in the smallest error from the ideal response of the EPR4 channel.
      <br/>
      To achieve this, we compute mean square errors for the two possible states, as follows:
    </p>
    <p num="20">For the case of a transition from "3" to "6" with xk =0, the mean square error=(yk -xk)2 =(yk -0)2 =yk2.</p>
    <p num="21">For the case of a transition from "7" to "6" with xk =-1, the mean square error (yk -xk)2 =(yk -(-1))2 =yk2 +2yk +1.</p>
    <p num="22">
      Since yk2 is common to both mean square errors, it can be eliminated from the metric calculations.
      <br/>
      The smallest mean square error is chosen, indicating the state most likely correct (i.e., the state most likely to have been the state previous to "6").
      <br/>
      Therefore, in our example, if 2yk +1 is greater than zero, then the selected state will be "3," or 001, and the data bit three units prior in time will have been 0.
      <br/>
      If, however, 2yk +1 is less than zero, the selected state will be "7," or 111, and the data bit three units prior in time will have been 1.
      <br/>
      In the case where 2yk +1 is equal to zero, meaning the likelihood of previous states "3" and "7" is the same, the state "3" can be selected to permit calculations to proceed.
    </p>
    <p num="23">
      It is often easier in circuit implementations to compute a maximum value rather than a minimum value.
      <br/>
      Therefore, the equations above are normalized and simplified by dividing through by -2 and adding a constant term "0.5" to both equations.
      <br/>
      Thus, a metric value at time k is derived for state "6" as follows: Mk (6)=Max+Mk-1 (3)+0.5, Mk-1 (7)-yk }. This equation states that the likelihood of state "6" at time k is assigned a value which is the larger of the previous metric associated with state "3" plus a constant term of "0.5," or of the previous metric associated with state "7" minus the received sample yk.
      <br/>
      If the former is chosen then the decision Ik-3 is 0 since the previous state was 011="3".
      <br/>
      Otherwise, the decision is 1 from 111="7".
      <br/>
      Note that the decision made at k is for Ik-3 and has three code periods delay associated with it.
    </p>
    <p num="24">
      Similarly, for the remaining seven states after similar manipulations we have the following equations.
      <br/>
      The equation for state "6" given above is included for completeness:
      <br/>
      Mk (0)=Max+Mk-1 (0)+0.5, Mk-1 (4)-yk },
      <br/>
      Mk (1)=Max+Mk-1 (0)+yk, Mk-1 (4)+0.5},
      <br/>
      Mk (2)=Max+Mk-1 (1)+yk, Mk-1 (5)+0.5},
      <br/>
      Mk (3)=Max+Mk-1 (1)+2yk -1.5, Mk-1 (5)+yk },
      <br/>
      Mk (4)=Max+Mk-1 (2)-yk, Mk-1 (6)-2yk -1.5},
      <br/>
      Mk (5)=Max+Mk-1 (2)+0.5, Mk-1 (6)-yk },
      <br/>
      Mk (6)=Max+Mk-1 (3)+0.5, Mk-1 (7)-yk },
      <br/>
      Mk (7)=Max+Mk-1 (3)+yk, Mk-1 (7)+0.5},
    </p>
    <p num="25">
      The above computations, algebraically manipulating previous metrics to provide current values of metrics, are called ACS computations since they involve an Add, Compare and Select process.
      <br/>
      At the end of every code period, every state has a metric value, indicating the likelihood that the channel is in that state.
      <br/>
      In addition, every state has a sequence of decisions associated with itself.
      <br/>
      Eight sets of these data are then fed into a register called the "survival path register." This register performs the final selection of data, Ik-3, with some further delay that is dependent on the particulars of the survival path register implementation chosen.
      <br/>
      As will be recognized by those skilled in the art, the object of all survival path registers, whatever their implementation, is to pick the most likely sequence among the eight possible candidates.
    </p>
    <p num="26">
      FIG. 3 is a state transition diagram.
      <br/>
      As its name implies it simply shows the history of state transitions from one code period to the next.
      <br/>
      Such diagrams are often used to describe Viterbi path "merge." If the survival path register is sufficiently long, the path will tend to "merge," i.e., all eight decisions tend to be identical, making the particular state from which data is chosen unimportant.
      <br/>
      The particulars of survival path registers are not important and the implementation is always digital.
    </p>
    <p num="27">
      The prior art has most commonly implemented Viterbi detectors in the digital domain after A/D conversion.
      <br/>
      Such implementations may result in loss of performance, loss of achievable data rate, or both.
      <br/>
      A very straightforward analog approach would be to attempt the above-described ACS computations in one period, Tc.
      <br/>
      However, this approach does not lend itself to the data rate requirement of current HDDS.
    </p>
    <p num="28">
      To overcome the speed limitation of the one-step approach, another conceivable analog implementation would be to use a two-step approach illustrated in FIGS. 4(a) and 4(b).
      <br/>
      With this approach, ACS computations would be carried out in two code periods, or 2Tc.
      <br/>
      For example, as shown in FIG. 4(a), instead of determining path metrics for the transition in one code period from "3" to "6" and "7" to "6," as before, path metrics would be calculated for the transitions from "1" to "3" to "6," "5" to "3" to "6," "3" to "7" to "6" and "7" to "7" to "6." This approach necessarily increases speed at the expense of hardware complexity.
      <br/>
      Instead of making the two-way decision as described above, a four-way decision would be performed at every other code period (Radix 4).
      <br/>
      Using this approach, the metric update equations for state "i" become:
      <br/>
      Mk (i)=Max+Mk-1 (j)+etc.,Mk-1 (k)+etc.}
      <br/>
      =Max+Max+Mk-2 (l)+etc., Mk-2 (m)+etc.},Max(Mk-2 (n)+etc., Mk-2 (o)+etc.}}
      <br/>
      =Max+Mk-2 (l)+etc., Mk-2 (m)+etc., Mk-2 (n)+etc., Mk-2 (o)+etc.}.
    </p>
    <p num="29">
      Here states j and k are two possible states at time k-1 from which state "i" could have come.
      <br/>
      States I and m, and n and o, are four possible states at time k-2 from which states j and k respectively, could have come.
      <br/>
      For example, for "i "=6=110, the metric equations become:
      <br/>
      Mk (6)=Max+Mk-1 (3)+0.5, Mk-1 (7)-yk }
      <br/>
      =Max+Max+Mk-2 (1)+2yk-1 -2.5, Mk-2 (5)+yk-1 },Max+Mk-2 (3)+yk-1, Mk-2 (7)+0.5}}.
      <br/>
      =Max+Mk-2 (1)+2yk-1 -2.5, Mk-2 (5)+yk-1, Mk-2 (3)+yk-1, Mk-2 (7)+0.5}.
    </p>
    <p num="30">Thus (j,k) are 3=011 and 7=111 and (l,m) and (n,o) are 001="1," 101="5," and 011="3," and 111="7." Associated decisions, Ik-4, Ik-3, are 00,10,01,11 for states "1," "5," "3" and "7," respectively.</p>
    <p num="31">
      Thus, the two step approach requires Additions involving two past samples, yk, yk-1, Comparisons of four metrics and Selections of the largest metric out of the four.
      <br/>
      FIG. 4(b) is a block diagram illustrating this two-step approach, and a timing diagram therefor.
      <br/>
      Two samples, yk, and also yk-1, are inputted to a detector such that four metrics are calculated and the largest metric, Mk, is stored by capacitors CHA and CHB alternately.
      <br/>
      The selection process of the largest metric also yields the decisions.
      <br/>
      The metric calculations must be done in two code periods, for example 10 nanoseconds in the example of FIG. 4(b).
      <br/>
      While this implementation would still present a workable approach, it is complex and the hardware required to realize it would be very costly, not only in terms of silicon area, but also in terms of matching of components needed to achieve near-ideal performance.
    </p>
    <heading>SUMMARY OF THE INVENTION</heading>
    <p num="32">
      To overcome the limitations of the related art discussed above, and to achieve further advantages that will become apparent in the foregoing description, the present invention provides a metric calculator that can be implemented using analog components.
      <br/>
      Using the interleaved architecture disclosed herein, the invention computes and updates metrics, and derives decisions based on these computations at code rate, but by two sets of identical circuits.
      <br/>
      The first set of circuits compute metrics during one phase of the signal clock, while the second set compute metrics during the second phase of the signal clock.
      <br/>
      By sharing the computations in this fashion, the metric calculator permits all metric updates and decisions to be generated at code rate, without requiring that all ACS computations be done in one code period.
      <br/>
      Instead, the interleaved architecture allows ACS computations to be performed effectively in two code periods.
    </p>
    <p num="33">
      In this analog implementation, two track and hold (T/H) circuits are used to sample input signals at opposite clock phases.
      <br/>
      These voltages are converted by voltage-to-current samplers into current signals that are in turn provided to the interleaved metric calculators at every code rate.
      <br/>
      Each interleave uses a maximum circuit and a track and hold circuit, and in conjunction with the other interleave calculates metrics.
      <br/>
      Specifically, an interleave that has begun the metric computation immediately provides it to the other interleave that has just begun the sampling process of an input signal so that the latter circuit can begin an Add/Compare/Select function before the former has fully acquired the accurate metric.
    </p>
    <p num="34">The present invention will be more fully understood by those of ordinary skill in the art upon consideration of the following detailed description of a preferred embodiment of the present invention, together with the accompanying drawings, in which like reference numerals refer to like elements.</p>
    <heading>BRIEF DESCRIPTION OF THE DRAWINGS</heading>
    <p num="35">
      FIGS. 1(a)-1(d) illustrate a simple example of an EPR4 channel response to an input signal.
      <br/>
      FIGS. 2(a)-2(d) illustrate another example of an EPR4 channel response to a different input signal.
      <br/>
      FIG.3 illustrates a state transition diagram showing the history of state transitions from one channel code period to the next.
      <br/>
      FIG. 4(a) illustrates a state transition diagram for a two-step approach that can be used in maximum likelihood sequence estimation.
      <br/>
      FIG 4(b) further illustrates the hardware and timing requirements for a two-step approach.
      <br/>
      FIG. 5 illustrates a block diagram of a preferred embodiment of an interleaved detector according to the present invention.
      <br/>
      FIGS. 6(a) and 6(b) illustrate the circuit configuration and timing diagram of a preferred embodiment of the present invention.
      <br/>
      FIG. 7 illustrates a latching circuit used in a detector according to a preferred embodiment of the present invention.
    </p>
    <heading>DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENT</heading>
    <p num="36">A presently preferred embodiment of the invention will now be explained in terms of the aforedescribed drawings and the following description.</p>
    <p num="37">
      FIG. 5 illustrates a block diagram of a preferred embodiment of an interleaved metric calculator according to the present invention.
      <br/>
      This interleaved architecture provides a metric calculator calculating and updating metrics and decisions at code rate, without requiring that all ACS computations be done in one code period, Tc.
      <br/>
      Instead, by doubling the number of circuits calculating metrics, the architecture allows 2Tc code periods for ACS units, and the speed required of the hardware is equivalent to the two-step approach discussed above with reference to FIGS. 4(a) and 4(b).
    </p>
    <p num="38">
      It will be appreciated by those of ordinary skill in the art that the metric calculator illustrated in FIG. 5 may be used in a larger read channel circuit used to read and decode data from a hard disk drive system.
      <br/>
      The calculator is typically used in a read channel in conjunction with a variable gain amplifier for receiving the read signal, as well as numerous other circuits such as filters, clock generators, and synchronizers.
    </p>
    <p num="39">
      The metric calculator illustrated in FIG. 5 is made up of an upper interleave and a lower interleave.
      <br/>
      The upper interleave is indicated by blocks 502, 504, and 506-514.
      <br/>
      The lower interleave is indicated by blocks 502', 504', and 506'-514'. Blocks 502 and 502' represent voltage samplers at opposite phases 1 and 0, respectively.
      <br/>
      These voltage samplers are also referred to in the art as differential track and hold, or dtkhd, circuits.
      <br/>
      Connected to blocks 502 and 502' are blocks 504 and 504', representing voltage-to-current converters for providing current proportional to the sampled channel signals.
      <br/>
      These elements are referred to in the art as differential track and hold voltage to current converters, or dtkhdvi.
      <br/>
      They are used in this embodiment of the present invention to permit all calculations to take place by use of positive and negative current values proportional to the sampled voltage input signal.
      <br/>
      Connected, in turn, to each of these voltage to current converters 504 and 504' are eight ACS units, represented by blocks 506-514 and 506'-514'. Each ACS unit calculates the metric for states 0 through 7, for alternating samples of the input signal, yk, and yk-1.
    </p>
    <p num="40">
      The outputs of upper interleave ACS units 506-514, each providing a metric value obtained for the previous code period, are selectively connected to the inputs of lower interleave ACS units 506'-514' according to the metric equations discussed above, so that calculation of subsequent metrics for each state can proceed.
      <br/>
      Similarly, the outputs of lower interleave ACS units 506'-514' are connected, as required, to the inputs of upper interleave ACS units 506-514 to perform subsequent metric calculations.
      <br/>
      To illustrate, the metric calculator 510' for state "2" needs to know the metrics for the previous code period of states "1" and "5," since Mk (2)=Max+Mk-1 (1)+yk, Mk-1 (5)+0.5}. Therefore, the outputs of upper interleave ACS circuits 508 and 512, which have calculated the metric for the previous code period, are provided, through line 516, to lower interleave ACS circuit 510'. Similarly, metrics for state "1" and "5" calculated by the lower interleave ACS circuits 508' and 512' are provided as inputs to upper interleave ACS circuit 510, through line 516', so that the following metric for state "2" can be calculated.
    </p>
    <p num="41">
      As indicated at lines 518 and 518' in FIG. 5, each of the current converters 504 and 504' provides twelve outputs indicating a current proportional to the sampled voltage yk and yk-1.
      <br/>
      These twelve outputs are necessary to carry out computations according to the metric equations discussed above for states 0 to 7, each equation requiring its own sample or samples of yk.
      <br/>
      For example, the equation for Mk (0) is Max+Mk-1 (0)+0.5, Mk-1 (4)-yk }, and requires one negative yk term.
      <br/>
      Current converters 504 and 504' will therefore provide, through lines 518 and 518', a current value proportional to the negative value of the samples yk and yk-1 to ACS blocks 506 and 506', respectively.
      <br/>
      Similarly, the equation for Mk (1), Max+Mk-1 (0)+yk, Mk-1 (4)+0.5}, requires one positive yk term.
      <br/>
      Therefore, blocks 508 and 508' receive a current value proportional to sample yk and yk-1 respectively.
      <br/>
      To provide another example, lines 518 and 518' must each provide three current samples for Mk (3) and Mk-1 (3), as given by +Max+Mk-1 (1)+2yk -1.5, Mk-1 (5)+yk }. Altogether, twelve such yk current values are provided to the ACS circuits so that metric calculations for all states can proceed.
    </p>
    <p num="42">
      Also shown in FIG. 5 are bias generators 520 and 524, connected to the inputs of upper interleave ACS circuits 506-514.
      <br/>
      Bias generators 520' and 524' are connected to the inputs of lower interleave ACS circuits 506'-514'. These bias generators provide DC bias currents of 0.5 and -1.5, respectively, to allow the metric equations discussed above to proceed.
      <br/>
      For example, the bias current 0.5 is provided to ACS circuits 506 and 506' to determine Mk (0)=Max+Mk-1 (0)+0.5, Mk-1 (4)-yk }. There are six "0.5" terms and two "-1.5" terms.
    </p>
    <p num="43">
      Those skilled in the art will appreciate that a common mode feedback device (not shown) is typically connected to ACS circuits 506-514 and 506'-514'. Such a feedback device will prevent metric values from continually growing beyond the dynamic range of the circuit.
      <br/>
      The feedback device will, for example, add up metrics from states "0" through "7," divide the result by eight, and subtract the calculated average from each metric value in each ACS circuit.
    </p>
    <p num="44">
      In operation, blocks 506-514 and 506'-514' alternately calculate metrics for eight possible states in a given signal channel.
      <br/>
      The upper interleave is provided data yk by the upper differential track and hold circuit 502.
      <br/>
      As indicated by the "1" on circuit 502, circuit 502 is in tracking (sampling) mode during phase "1" and holding mode during phase "0." As indicated by the "0" on the upper voltage to current converter 504, converter 504 is updated by circuit 502 during phase "0" and holds its value during phase "1." The lower interleave is provided data yk-1 by lower different track and hold circuit circuit 502'. As indicated by the "0" on circuit 502', circuit 502' is in tracking (sampling) mode during phase "0" and holding mode during phase "1." As indicated by the "1" on the lower voltage to current converter 504', this converter is updated by circuit 502' during phase "1" and holds its value during phase "0."
    </p>
    <p num="45">
      Thus, the top interleave in FIG. 5 calculates metrics using yk samples obtained during clock phase "1," and held during phase "0." The bottom interleave calculates metrics using yk-1 samples obtained one period later, during clock phase "0," and held during phase "1." The value of the sample yk received from sampler 502 updates differential track and hold circuit 504.
      <br/>
      Circuit 504 then holds this value during phase "1" for continued use by ACS circuits 506-514.
      <br/>
      Similarly, the value of the sample yk-1 received from sampler 502' updates differential track and hold circuit 504' during phase "1." Circuit 504' then holds this value during phase "0" for continued use by ACS circuits 506'-514'. As will be explained below with reference to FIGS. 6(a) and 6(b), this arrangement of sampling and holding input values at opposite phases works in tandem with tracking and holding of metrics calculated during opposite phases by ACS circuits 506-514 and 506'-514' to allow interleaved calculation of metrics.
    </p>
    <p num="46">
      FIGS. 6(a) and 6(b) illustrate the circuit configuration and timing diagram of the preferred embodiment of the present invention discussed above generally with reference to FIG. 5.
      <br/>
      FIG. 6(a) illustrates two ACS circuits from FIG. 5, one from the upper interleave and another from the lower interleave.
      <br/>
      These circuits will be explained by first identifying the elements in the upper interleave portion of FIG. 6(a), then identifying the timelines in FIG. 6(b), and then describing the operation of FIG. 6(a) with reference to the timelines in FIG. 6(b).
    </p>
    <p num="47">
      FIG. 6(a) illustrates a circuit implementation of the ACS units shown in FIG. 5 for computing the metric for state "6." Element 632, connected to voltage sampler 502 and voltage to current converter 504, from FIG. 5, is a single ACS circuit for the state "6" in the upper interleave of FIG. 5.
      <br/>
      Element 632', connected to voltage sampler 502' and voltage to current converter 504', is a single ACS circuit for the state "7," in the lower interleave of FIG. 5.
      <br/>
      Generally, as shown in FIG. 6(a), each ACS circuit includes a maximum circuit and a metric track and hold (T/H) circuit.
      <br/>
      Using previous metrics calculated by maximum circuits of the lower interleave, the maximum circuits of the upper interleave begin calculating the metric for one of states "0" through "7" during a first phase of a clock, and complete this process during a second phase to reach a final metric value.
      <br/>
      The metric track and hold circuits for the upper interleave receive the final metric value during the second phase of the clock, and hold this value during a third phase of the clock so it can be used by the lower interleaves to calculate subsequent metrics for states "0" through "7".
    </p>
    <p num="48">
      ACS circuit 632 connects to voltage to current converter 504 through the base of transistor 608, which is connected by its emitter to the emitter of transistor 604 to form a maximum circuit.
      <br/>
      Also coupled to the base of transistor 608 is resistor 614, which is coupled at its other end to the ACS circuit for state "7" in the lower interleave circuit to receive Mk-1 (7).
      <br/>
      The base of transistor 604, on the other side of the comparator, is connected to resistor 612.
      <br/>
      Resistor 612, at its other end, will receive the metric for state "3," Mk-1 (3), from the bottom interleave.
      <br/>
      The base of transistor 604 is also connected to a bias current from bias current generator 520.
      <br/>
      Bias current generator 520 is in turn connected at its other end to supply voltage V+. The emitters of transistors 604 and 608 are both connected to current source 618, which is connected at its other end to ground.
      <br/>
      Also connected to the emitter of transistors 604 and 608 is the emitter of a third transistor, 610.
      <br/>
      The collectors of transistors 604 and 608 are connected to a decision circuit, which will be discussed below with reference to FIG. 7.
      <br/>
      The collector of transistor 610 is connected to a current source 640, in turn connected to supply voltage V+. The base of a fourth transistor 616 is connected to the collector of transistor 610.
      <br/>
      The collector of transistor 616 is connected to V+, and its emitter is connected to the base of transistor 610, as well as to current source 620, which is in turn connected to ground.
    </p>
    <p num="49">
      A resistor 622 is connected to the emitter of transistor 616, and is connected at its other end to the collector of transistor 624, and the base of transistor 630.
      <br/>
      The emitter of transistor 624 is connected to another transistor 626, and both emitters are connected to ground through a current source 628.
      <br/>
      The collector of transistor 626 is connected to the emitter of transistor 630, which is, in turn, connected at its collector to the power supply, V+. Transistor 635 is connected at its base to a clamp voltage, at its collector to V+and at its emitter to the base of transistor 630.
      <br/>
      A holding capacitor, CHA, is connected at one end to V+, and at the other end to the emitter of transistor 630 and to the input of a buffer 634.
      <br/>
      The output of buffer 634 provides the metric Mk (6), which is used by ACS circuits for states "4" and "5" in the lower interleave.
    </p>
    <p num="50">
      As can be appreciated from comparison of the upper and lower circuits in FIG. 6(a), the ACS circuits for Mk (6) and Mk-1 (7) are very similar.
      <br/>
      One difference, due to their being on different interleaves, is that they are designed to sample and hold at opposite times, both at their input sampling stages and in their metric track and hold circuits.
      <br/>
      Other differences are due to the differences between required metric calculations for Mk (6) and Mk-1 (7).
      <br/>
      For example, Mk (6) requires a negative yk term added at the base of transistor 608, while Mk-1 (7) requires a positive yk term added at the base of transistor 604'. Similarly, a 0.5 current bias must be added to the base of transistor 608', whereas the upper interleave required this bias for transistor 604.
      <br/>
      Because ACS circuits operate based on the same principles and are the same except for these noted differences, an explanation will be provided below only for the operation of ACS circuit 632 in the upper interleave of FIG. 6(a).
    </p>
    <p num="51">
      ACS circuit 632 has two parts, a maximum circuit, and a metric track and hold circuit.
      <br/>
      The operation of these circuits can be best understood with reference to the timing diagrams, labeled 1-10, in FIG. 6(b).
      <br/>
      Line 1 on FIG. 6(b) represents a clock signal whose period equals twice the code period, Tc.
      <br/>
      In this example, the frequency of the clock is 100 Mhz, so there are ten nanoseconds in each clock period and five nanoseconds in each code period, Tc, of phase "0" or "1." On line 2 there is a diagram illustrating the signal y0, representing the output of voltage sampler 502 as sampled by voltage to current converter 504 during phase "0," and held during phase "1." On line 3, a diagram illustrates current i0, the output of voltage to current converter 504 updated during each phase "0." The diagram on line 4 illustrates the metric value building at node "a," in upper interleave ACS circuit 632.
      <br/>
      Next, line 5 illustrates the metric value stored on capacitor CHA in upper interleave ACS circuit 632.
      <br/>
      The update of this metric value is initiated at the beginning of phase "1" when a metric track and hold circuit is activated to transfer voltage at node "a" to CHA.
      <br/>
      The following diagram on line 6 illustrates the final metric value, A, received at the output of buffer 634.
      <br/>
      Continuing down the figure, the next diagram on line 7 illustrates y1 the voltage sampled by sampling circuit 502' as sampled by the voltage to current converter 504' during phase "1," and held during phase "0." The diagram on line 8 illustrates the voltage at node "b" in the lower interleave.
      <br/>
      The voltage in capacitor CHB is shown by line 9.
      <br/>
      The final metric value at node B, at the output of buffer 634', is shown on line 10.
    </p>
    <p num="52">
      Voltage sampler 502 samples the input signal during phase "1," and holds in phase "0" during which voltage to current converter 504, that provides the current used by ACS circuit 632, is updated.
      <br/>
      As shown in FIG. 6(b) at line 3, current i0 begins to ramp up during phase "0." The maximum circuit of ACS unit 632 includes transistor pair 604 and 608 for calculating Mk (6)=Max+Mk-1 (3)+0.5, Mk-1 (7) -yk }. Specifically, the base of transistor 604 receives constant DC current of 0.5. It also receives a voltage representing Mk-1 (3) through resistor 612.
      <br/>
      Thus, at the base of transistor 604, the voltage formed is Mk-1 (3)+0.5. At the base of transistor 608, a voltage representing the previous metric Mk-1 (7), from the lower interleave, is provided through to the top end of resistor 614.
      <br/>
      Added to this current is a current proportional to -yk, to provide a voltage corresponding to Mk-1 (7)-yk.
    </p>
    <p num="53">
      As voltage to current converter 504 begins to convert voltage yk into current i0, and the previous metrics for states "3" and "7" begin to impress themselves through resistors 612 and 614, the Add/Compare/Select functions of the ACS circuit are initiated simultaneously.
      <br/>
      With the circuit still operating during phase "0," as the voltages develop at the bases of transistors 604 and 608, the larger value will dominate, and will begin to develop at node "a." Transistors 610 and 616, together with either of transistors 604 or 608, whichever dominates during operation, provide a unity gain buffer that transfers the larger of the two values at the bases of transistors 604 and 608 to node "a" during phase "0." This effect is shown by the diagram on line 4 in FIG. 6(b) which shows the voltage "a" ramping up during phase "0," and continuing into phase "1".
    </p>
    <p num="54">
      At the end of phase "0," the metric Mk is substantially acquired, but not necessarily fully accurate, at node "a." Stated differently, Mk may be very close to its final value, but may not have had enough time during phase "0" to reach its final value.
      <br/>
      If metrics in this circuit were required to be calculated during a single code period, this failure to reach a final value would be unacceptable and might lead to errors in data detection.
      <br/>
      However, as explained below, the interleaved configuration of FIG. 6(a) allows the final value to be reached by the end of the subsequent phase "1."
    </p>
    <p num="55">
      The circuit of FIG. 6(a) provides increased time to achieve a final value because of two features.
      <br/>
      The first feature is that voltage to current converter 504 continues to hold the sampled value of the input, i0, during phase "1." This feature is illustrated in FIG. 6(b), line 3, by the straight horizontal sections defining current i0, during the latter part of each period in phase "1." Because the sampled input value is held, it is available for transistors 604, 608 and 610 to continue their compare and select functions.
    </p>
    <p num="56">
      The second feature allowing the circuit more time to reach a final metric value is that track and hold circuits in each ACS circuit hold their previous metric values during the phase subsequent to the one in which they were updated.
      <br/>
      This feature is illustrated in FIG. 6(b), lines 5 and 6.
      <br/>
      Specifically, metric "A," representing Mk (6), is updated during clock phases "1," following the turning on of transistor 626, to transfer the voltage at node "a" to capacitor CHA.
      <br/>
      But, as indicated by the horizontal sections of the diagram in FIG. 6(b), line 6 during this time, A can be used to initiate the metric update in the lower interleave.
      <br/>
      And since the metric value for A settles and holds during "0" it can be used by bottom interleave ACS circuits during phase "0" to complete the lower interleave metrics update as shown in "b" &amp; CHB in FIG. 6(b).
    </p>
    <p num="57">
      As illustrated in FIG. 6(b), lines 4 and 5, when phase "1" begins, the metric value continuing to build at node "a" is allowed to start transferring to capacitor CHA.
      <br/>
      It is then necessary that the updated metric be fully captured on to CHA by the end of phase "1".
      <br/>
      Thus, there are essentially 2Tc periods available to acquire the new metric on to CHA, so long as the voltage from node "a" is transferred quickly enough to capacitor CHA, such that it is not the speed limiting bottleneck of the circuit.
    </p>
    <p num="58">
      As further illustrated in FIG. 6(b), line 6, with the configuration of the circuit shown in FIG. 6(a), as the new metric begins to assert itself at CHA it is immediately used, via the buffer with its output at node A, in the computation of the next metric update in the lower interleave.
      <br/>
      Again, it is not necessary for the computation to be complete and accurate by the end of the phase "1".
      <br/>
      All it has to do is to reach a value such that at the end of the next phase "0," during which an upper interleave capacitor is holding a metric value, a new metric is fully captured on the holding capacitor of the lower interleave, such as capacitor CHB.
      <br/>
      Holding is accomplished by steering current 628 (628') through transistor 624 (624') to develop a voltage drop through resistor 622 (622') to clamp the base of transistor 630 (630'), such that transistor 630 (630') is turned off.
    </p>
    <p num="59">
      Unlike prior art ACS circuits that first compared two metric values and then selected the most-likely correct or largest one, the select process of the circuit of FIG. 6(a) does not need to await the completion of the compare process.
      <br/>
      These processes occur, by the very nature of the ACS realization discussed here, simultaneously.
      <br/>
      Thus, if two metrics are very close, the resulting metric update would be in error due to the fact that both 604 and 608 conduct current (Vbe error).
      <br/>
      However, the error associated with the Vbe error can be ignored by properly scaling metric swings such that Vbe errors are negligible compared to the metric swings.
    </p>
    <p num="60">
      FIG. 7 illustrates a circuit that may be used according to a preferred embodiment to latch a decision from the circuit shown in FIG. 6.
      <br/>
      Thus far, the description of FIGS. 5, 6(a), and 6(b) has concerned calculation of metrics by using two previous metrics, required constants 0.5 and -1.5, and the sampled input voltage yk.
      <br/>
      But data sequence detection requires in addition that a sequence detector keep track of which of the compared metrics was larger.
      <br/>
      More specifically, a survival path register must be fed with decisions obtained after each comparison of metrics, as indicated by the metric equations discussed earlier, to provide the likely value of the data Ik-3, three code periods prior to the current period, k.
    </p>
    <p num="61">
      In FIG. 7, the clocking scheme is for the top interleave in FIG. 6(a), and transistors 604, 608, 610, 616, and 640 are as indicated in FIG. 6(a).
      <br/>
      As shown by the dotted lines in FIG. 7, transistor pairs 706 and 718, 710 and 714, and 720 and 721, along with biasing resistors 708, 716, 704, and 720, and current source 736, constitute a decision circuit connected to the collectors of transistors 604 and 608.
      <br/>
      More specifically, a resistor 704 is connected at one end to V+, and at the other end to the collector of transistor 604.
      <br/>
      Similarly, a resistor 720 is connected at one end to V+, and at the other end to the collector of transistor 608.
      <br/>
      Emitter-connected transistors 706 and 718 are connected at their bases to the collectors of transistors 604 and 608, respectively.
      <br/>
      The collectors of transistors 706 and 718 are, in turn, connected to bases of emitter-connected transistors 710 and 714.
      <br/>
      The emitters of these transistors are connected to a latching circuit using emitter-connected transistor pair 720 and 721, whose emitters are coupled to ground by a current source 736, and whose bases are controlled by clock phases "0" and "1," respectively.
      <br/>
      The collectors of transistor 710 and 714 are cross-connected to biasing resistors 708 and 716, which are connected on the other side to V+. A differential output representing a decision regarding Ik-3 is provided across resistors 708 and 716, and fed to a survival path register.
    </p>
    <p num="62">
      During operation, data associated with Ik-3, or the first bit of the previous state is decoded in the decision circuit of FIG. 7, just as transistors 604 and 608 are performing their comparison and selection of the largest value in a metric equation.
      <br/>
      For example, during computation of Mk (0), it is necessary to determine which of (Mk-1 (0)+0.5) or (Mk-1 (4)-yk) is larger.
      <br/>
      If the latter is larger, then the first bit "1" associated with the state "4" or 100 is stored and the decision in FIG. 7 across resistors 708 and 716 is "1." Conversely, if the former value is larger, then the first bit "0" associated with state 000 would be stored, and the decision output differentially across resistors 708 and 716 would be "0." Each time a metric calculation is performed by transistors 604 and 608, and the metric value has reached its final value, a decision is provided by transistor pair 706 and 718.
      <br/>
      In the case of the ACS circuit 632 in the upper interleave of FIG. 6(a), a decision is latched during phase "0" by transistor 720, and released during phase "1" by transistor 721.
      <br/>
      As is known in the art, a survival path register keeps track of these decisions to make the final determination regarding the value Ik-3, based on the stored decisions from each state for a number of periods.
    </p>
    <p num="63">
      The foregoing description illustrates a preferred embodiment of an interleaving architecture that allows two code periods for ACS computations by doubling the hardware used to perform computations.
      <br/>
      The hardware complexity of this interleaved approach is comparable to the two-step approach described with reference to FIGS. 4(a) and 4(b) above, but the accuracy required of computations with this approach is much more relaxed.
    </p>
    <p num="64">
      Preferred embodiments of the present invention can provide significant advantages of speed, and operate at greater than 200 Mbps with 0.8 u BICMOS technology.
      <br/>
      They can reduce signal processing speed requirements to one half of a non-interleaved architecture and provide very close to ideal performance, utilizing the inherent matching properties of, first and foremost, NPN transistors and other components available in BICMOS technology.
      <br/>
      These embodiments can also advantageously provide accurate and full (not simplified) 8 state EPR4 Viterbi calculation in BICMOS technology beyond 200 Mbps.
    </p>
    <p num="65">
      Having described a preferred circuit configuration embodying the invention, those skilled in the art will appreciate that various modifications may be made of the invention without departing from its spirit.
      <br/>
      Therefore, it is not intended that the scope of this invention be limited to the specific embodiments illustrated and described herein.
      <br/>
      Rather, it is intended that the scope of the invention be determined by the appended claims and their equivalents.
    </p>
  </description>
  <claims format="original" lang="en" id="claim_en">
    <claim num="1">
      <claim-text>What is claimed is:</claim-text>
    </claim>
    <claim num="15">
      <claim-text>15.</claim-text>
      <claim-text>An interleaved metric calculator comprising: (a) a first circuit calculating a first set of metric values during a first time period and also during at least a portion of a second time period following the first time period, using at least a first sample of a recorded signal initially received during said first time period, and continued to be received during the second time period; (b) a second circuit calculating a second set of metric values during the second time period and also during at least a portion of a third time period following the second time period using at least a second sample of the recorded signal initially received during the second time period, and continued to be received by the second circuit during the third time period; (c) a third circuit that obtains the calculated metric values from the first circuit during the second time period and holds them during the third time period;</claim-text>
      <claim-text>and (d) a fourth circuit that obtains the calculated metric values from the second circuit during the third time period and holds them during a fourth time period following the third time period, wherein:</claim-text>
      <claim-text>- the calculation performed by said first circuit provides approximate metric values by the end of the first time period, and provides completely accurate metric values by the end of the second time period, and the calculation performed by said second circuit provides approximate metric values by the end of the second time period, and provides more accurate metric values during the third time period.</claim-text>
      <claim-text>1. In a read channel device, an interleaved metric calculator providing a set of decisions at a code rate to a survival register for maximum likelihood detection of a binary signal sequence recorded on a medium and detected through a channel characterized by a set of multi-bit sequences defining possible channel states, signals in said signal sequence having a code period inversely proportional to the code rate, said decisions being based on a pair of metrics calculated for each state, comprising:</claim-text>
      <claim-text>(a) a first set of circuits approximately calculating metric values for at least some channel states during a first code period and completing calculation of these metric values during a second code period subsequent to the first code period, using, in part, a first sample of the recorded signal, initially received by the first set of circuits during the first code period and continued to be received during the second code period; (b) a second set of circuits approximately calculating metric values for at least some channel states during the second code period and completing calculation of these metric values during a third code period subsequent to the second code period, using, in part, a second sample of the recorded signal, initially received by the second set of circuits during the second code period and continued to be received during the third code period; (c) a third set of circuits acquiring the metric values calculated by the first set of circuits during the second code period, making them immediately available to the second set of circuits, and holding these values during the third code period;</claim-text>
      <claim-text>and (d) a fourth set of circuits acquiring the metric values calculated by the second set of circuits during the third code period, making them immediately available to the first set of circuits, and holding these values during a fourth code period subsequent to the third code period.</claim-text>
      <claim-text>2. The metric calculator of claim 1, wherein: said first set of circuits perform metric calculations using at least said first sample of the recorded signal by algebraically changing said metric values made available by said fourth set of circuits.</claim-text>
      <claim-text>3. The metric calculator of claim 2, wherein: said second set of circuits perform metric calculations using at least said second sample of the recorded signal by algebraically changing said metric values made available by said third set of circuits.</claim-text>
      <claim-text>4. The metric calculator of claim 2, wherein: said algebraic changing of metric values includes performing at least one of addition and subtraction operations on the metric values made available by said fourth set of circuits using said second sample of the recorded signal and at least one reference value.</claim-text>
      <claim-text>5. The metric calculator of claim 4, wherein: said algebraic changing of metric values includes performing at least one of addition and subtraction operations on these metric values using said second sample of the recorded signal and at least one reference value.</claim-text>
      <claim-text>6. The metric calculator of claim 2, wherein: said first and second sets of circuits provide decisions to a survival register by comparing pairs of metric values computed.</claim-text>
      <claim-text>7. The metric calculator of claim 4, wherein: said decisions provided by said first set of circuits indicate whether a first bit in a multi-bit sequence defining a previous channel state was a one or a zero.</claim-text>
      <claim-text>8. In a read channel device, a method of providing a set of decisions at a code rate to a survival register for maximum likelihood detection of a binary signal sequence recorded on a medium and detected through a channel characterized by a set of multi-bit sequences defining possible channel states, signals in said signal sequence having a code period inversely proportional to the code rate, said decisions being based on a pair of metrics calculated for each state, comprising the steps of: (a) approximately calculating a first set of metric values using a first circuit for a least some channel states during a first code period and completing calculation of the first set of metric values during a second code period subsequent to the first code period, using, in part, a first sample of the recorded signal received during the first code period and held during the second code period; (b) approximately calculating a second set of metric values using a second circuit for said at least some channel states during the second code period and completing calculation of the second set of metric values during a third code period subsequent to the second code period, using, in part, a second sample of the recorded signal received during the second code period and held during the third code period; (c) acquiring the first set of metric values from the first circuit during the second code period, making them immediately available to the second circuit, and holding these values during the third code period;</claim-text>
      <claim-text>and (d) acquiring the second set of metric values from the second circuit during the third code period, making them immediately available to the first circuit, and holding these values during a fourth code period subsequent to the third code period.</claim-text>
      <claim-text>9. The method of claim 8, wherein: said step of calculating the first set of metric values comprises algebraically changing metric values made available from said second circuit using at least said first sample of the recorded signal.</claim-text>
      <claim-text>10. The method of claim 8, wherein: said step of calculating the second set of metric values comprises algebraically changing metric values made available from said first circuit using at least said second sample of the recorded signal.</claim-text>
      <claim-text>11. The method of claim 9, wherein: said algebraic changing of metric values made available from said second circuit includes performing at least one of addition and subtraction operations on these metric values using said first sample of the recorded signal and at least one reference value.</claim-text>
      <claim-text>12. The metric calculator of claim 10, wherein: said algebraic changing of metric values made available from said first circuit includes performing at least one of addition and subtraction operations on these metric values using said second sample of the recorded signal and at least one reference value.</claim-text>
      <claim-text>13. The method of claim 9, further comprising the step of: providing decisions to the survival register based on a comparison of metric values computed.</claim-text>
      <claim-text>14. The method of claim 13, wherein: said decisions provided to the survival register indicate whether a first bit in a multi-bit sequence defining a previous channel state was a one or a zero.</claim-text>
    </claim>
    <claim num="16">
      <claim-text>16. An interleaved metric calculator comprising: (a) a first circuit calculating a first set of metric values during a first time period and also during at least a portion of a second time period following the first time period, using at least a first sample of a recorded signal initially received during said first time period, and continued to be received during the second time period; (b) a second circuit calculating a second set of metric values during the second time period and also during at least a portion of a third time period following the second time period using at least a second sample of the recorded signal initially received during the second time period, and continued to be received by the second circuit during the third time period; (c) a third circuit that obtains the calculated metric values from the first circuit during the second time period and holds them during the third time period;</claim-text>
      <claim-text>and (d) a fourth circuit that obtains the calculated metric values from the second circuit during the third time period and holds them during a fourth time period following the third time period, wherein: - said third circuit immediately provides the calculated metric values from the first circuit to the second circuit after it obtains them, and said second circuit algebraically changes these calculated metric values using at least the second sample of the recorded signal to calculate the second set of metric values.</claim-text>
    </claim>
    <claim num="17">
      <claim-text>17. In a read channel device, an interleaved metric calculator providing a set of decisions at a code rate to a survival register for maximum likelihood detection of a binary signal sequence recorded on a medium and detected through a channel characterized by a set of multi-bit sequences defining possible channel states, signals in said signal sequence having a code period inversely proportional to the code rate, said decisions being based on a pair of metrics calculated for each state, comprising: (a) a first interleave circuit comprising a first set of ACS circuits and a first track and hold circuit, said first set of ACS circuits approximately calculating metric values for at least some channel states during a first code period and completing calculation of these metric values during a second code period subsequent to the first code period, using, in part, a first sample of the recorded signal, held during the first code period to update the first track and hold circuit, said first sample being provided to the first set of ACS circuits beginning during the first code period and being held during the second code period; (b) a second interleave circuit comprising a second set of ACS circuits and a second track and hold circuit, said second set of ACS circuits approximately calculating metric values for at least some channel states during the second code period and completing calculation of these metric values during a third code period subsequent to the second code period, using, in part, a second sample of the recorded signal, held during the second period to update the second track and hold circuit, said second sample being provided to the second set of ACS circuits beginning during the second code period and being held by the second track and hold circuit during the third code period; (c) a third set of circuits acquiring the metric values calculated by the first set of ACS circuits during the second code period, making them immediately available to the second set of circuits, and holding these values during the third code period;</claim-text>
      <claim-text>and (d) a fourth set of circuits acquiring the metric values calculated by the second set of ACS circuits during the third code period, making them immediately available to the first set of circuits, and holding these values during a fourth code period subsequent to the third code period.</claim-text>
    </claim>
  </claims>
</questel-patent-document>